<html>
<script>
//get the list
//http://stackoverflow.com/questions/247483/http-get-request-in-javascript
var xmlHttp = new XMLHttpRequest();
xmlHttp.open("GET","listaz.html",true);
xmlHttp.send(null);
//initialize list of ships so we can access it globablly
var filtered_array;
//this is done asyncrhonously, so need to check for when it's done to parse...
xmlHttp.onreadystatechange = function() {
    if (xmlHttp.readyState === 4) {
        if (xmlHttp.status === 200) {
            //turn raw HTML into a useful array
            var str_array = xmlHttp.response.split(/(?:<br>\r\n)|(?:<p>)/);
            //remove all the extraneous HTML from front and back
            var regex = new RegExp(".*Shipping.*");
            filtered_array = str_array.filter(function(s,i,a) {
                return regex.test(s);
            });

            //display the list while waiting for input....
            document.getElementById("list").innerHTML = filtered_array.join("<br>");
            
        }
        else {
            //there was a problem
        }
    }
}

//this runs when something is typed into the box
function filter_ships() {
    //get the text
    var search_str = document.getElementById("textinput").value;
    //check on options to make appropriate regex
    var case_sens = document.getElementById("case").checked;
    var flag;
    if (case_sens) {
        flag = "";
    }
    else {
        flag = "i";
    }
    var radios = document.getElementsByName("filter-type");
         
    //construct the regular expression
    //note: this is kind of a kludge and if/when String.contains leaves
    //experimental, that would be better
    var searchex = new RegExp(search_str.concat(".*"), flag);
    //now filter for ships that match the search
    var disp_array = filtered_array.filter(function(s,i,a) {
        var loc = s.search(searchex);
        //is the search term in the ship at all?
        if (loc != -1) {
            //if so, do we want it at start?
            if (radios[0].checked && loc == 0) {
                //if so and it is, return true
                return true;
            }
            else if (!radios[0].checked) {
                //if we don't care it's at start, return true
                return true;
            }
            else {
                //if we care and it's not at start, return false
                return false;
            }
        }
        else {
            return false;
        }
    });
    //display the ships
    document.getElementById("list").innerHTML = disp_array.join("<br>");
    
}

</script>
<body>
<form id="parameters">
Text is:<br>
<input type="radio" name="filter-type" value="start"> At Start<br>
<input type="radio" name="filter-type" value="contains"> In Phrase<br>
Search for: <input type="text" name="filter" id="textinput" oninput="filter_ships()"><br>
Case sensitive? <input type="checkbox" name="case" id="case" value="case"><br>
</form>
<div id="list"></div>
</body>
</html>
